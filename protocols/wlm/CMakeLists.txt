project(wlm)

find_package(KDE4 REQUIRED)
include(KDE4Defaults)
include(MacroLibrary)

find_package(Kopete REQUIRED)

include_directories(${KDE4_INCLUDES})
add_definitions(${QT_DEFINITIONS} ${KDE4_DEFINITIONS})

#ADD_SUBDIRECTORY(ui)
ADD_SUBDIRECTORY(icons)

set(KOPETE_INCLUDES /opt/kde4/include/kopete/ /opt/kde4/include/kopete/ui/ /home/kde4/svn/KDE/kdenetwork/kopete/libkopete/ /home/kde4/svn/KDE/kdenetwork/kopete/libkopete/ui/ /home/kde4/build/KDE/kdenetwork/kopete/) ### FIXME

include_directories(
    ${KOPETE_INCLUDES}
    ${CMAKE_CURRENT_SOURCE_DIR}/ui
)

kde4_add_ui_files(kopete_wlm_ui_SRCS
    wlmaddui.ui
    wlmaccountpreferences.ui
)

set(kopete_wlm_PART_SRCS
   ${kopete_wlm_ui_SRCS}
   wlmprotocol.cpp
   wlmcontact.cpp
   wlmaccount.cpp
   wlmaddcontactpage.cpp
   wlmeditaccountwidget.cpp
   wlmlibmsn.cpp
   wlmsocket.cpp
   wlmserver.cpp
   wlmchatmanager.cpp
   wlmchatsession.cpp
   wlmtransfermanager.cpp
   ui/wlmwebcamdialog.cpp
)

kde4_add_plugin(kopete_wlm ${kopete_wlm_PART_SRCS})

target_link_libraries(
    kopete_wlm 
    ${KDE4_KDEUI_LIBS} 
    ${KDE4_KUTILS_LIBS}
    ${KDE4_KIO_LIBRARY} 
    ${QT_QTXML_LIBRARY} 
    ${QT_QTNETWORK_LIBRARY} 
    kopete 
    kopete_videodevice 
    msn
)

install(TARGETS kopete_wlm  DESTINATION ${PLUGIN_INSTALL_DIR})

install(FILES  kopete_wlm.desktop DESTINATION ${SERVICES_INSTALL_DIR})
install(FILES  wlmchatui.rc DESTINATION ${DATA_INSTALL_DIR}/kopete_wlm)
